# Система відновлення пароля

Цей документ описує як використовувати систему відновлення пароля, яка була додана до додатку.

## Огляд функціональності

Система відновлення пароля складається з двох основних сторінок:

1. **ForgotPassword** - форма для введення email та відправки запиту на відновлення
2. **ResetPassword** - форма для встановлення нового пароля після переходу за посиланням

## Маршрути

- `/forgot-password` - сторінка відновлення пароля
- `/reset-password?token=...` - сторінка встановлення нового пароля

## Як це працює

### 1. Користувач натискає "Забув пароль?"

1. У формі логування (`LoginForm.tsx`) є кнопка "Забув пароль?"
2. При натисканні користувач перенаправляється на `/forgot-password` з email як параметром
3. Якщо email не введений, показується повідомлення

### 2. Форма відновлення пароля

1. Користувач вводить свій email
2. При відправці форми викликається API функція `sendForgotPasswordRequest`
3. Показується повідомлення про успішну відправку

### 3. Email з посиланням

1. Сервер генерує унікальний токен
2. Відправляє email з посиланням: `https://yourdomain.com/reset-password?token=TOKEN`
3. Токен має обмежений час дії (наприклад, 1 година)

### 4. Встановлення нового пароля

1. Користувач переходить за посиланням з email
2. Система валідує токен через `validateResetToken`
3. Якщо токен валідний, показується форма для нового пароля
4. Користувач вводить новий пароль та підтвердження
5. При відправці викликається `resetPassword`
6. Показується повідомлення про успішну зміну пароля

## API Endpoints

Для повної роботи системи потрібно реалізувати наступні API endpoints:

### POST /api/auth/forgot-password

```json
{
  "email": "user@example.com"
}
```

### GET /api/auth/validate-reset-token?token=TOKEN

Перевіряє валідність токена

### POST /api/auth/reset-password

```json
{
  "token": "reset_token_here",
  "password": "new_password"
}
```

## Файли

### Компоненти

- `src/pages/ForgotPassword.tsx` - сторінка відновлення пароля
- `src/pages/ResetPassword.tsx` - сторінка встановлення пароля

### Допоміжні функції

- `src/helpers/passwordReset.ts` - API функції та утиліти

### Стилі

- Додано CSS класи в `src/index.css`

### Маршрутизація

- Оновлено `src/routes/Config.tsx` з новими маршрутами

## Безпека

### Рекомендації для серверної частини:

1. **Токени**: Використовуйте криптографічно безпечні токени
2. **Термін дії**: Обмежте час дії токена (1-24 години)
3. **Одноразовість**: Токен повинен бути використаний тільки один раз
4. **Rate limiting**: Обмежте кількість запитів на відновлення
5. **Валідація email**: Перевіряйте, чи існує користувач з таким email

### Валідація на клієнті:

1. **Email**: Перевірка формату email
2. **Пароль**: Мінімум 8 символів, максимум 20
3. **Підтвердження**: Паролі мають співпадати

## Тестування

### Тестові сценарії:

1. **Відправка запиту без email** - повинно показати помилку
2. **Відправка запиту з невалідним email** - повинно показати помилку
3. **Відправка запиту з валідним email** - повинно показати успіх
4. **Перехід за невалідним токеном** - повинно показати помилку
5. **Встановлення пароля без підтвердження** - повинно показати помилку
6. **Встановлення пароля з неспівпадаючими паролями** - повинно показати помилку

## Налаштування

### Зміна URL endpoints:

Відредагуйте файл `src/helpers/passwordReset.ts`:

```typescript
// Змініть базовий URL API
const API_BASE_URL = "https://your-api-domain.com";

// Оновіть URL в функціях
const response = await fetch(`${API_BASE_URL}/api/auth/forgot-password`, {
  // ...
});
```

### Зміна валідації пароля:

Відредагуйте `validationSchema` в `ResetPassword.tsx`:

```typescript
const validationSchema = object({
  password: string()
    .required("Пароль є обов'язковим")
    .min(8, "Пароль має бути не менше 8 символів")
    .max(50, "Пароль має бути менше 50 символів") // змініть максимум
    .matches(
      /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,
      "Пароль має містити великі, малі літери та цифри"
    ),
  // ...
});
```

## Підтримка

При виникненні проблем:

1. Перевірте консоль браузера на наявність помилок
2. Перевірте, чи правильно налаштовані API endpoints
3. Перевірте, чи всі маршрути додані до конфігурації
4. Перевірте, чи правильно імпортовані всі компоненти
